# OpenTelemetry Configuration for Claude Code
# Source this file before running Claude Code for telemetry collection
#
# Usage:
#   source .env.telemetry
#   claude
#
# Or run directly:
#   env $(cat .env.telemetry | xargs) claude

# ===========================================================================
# OpenTelemetry SDK Configuration
# ===========================================================================

# Enable OTEL tracing and metrics
OTEL_SDK_DISABLED=false

# Service identification
OTEL_SERVICE_NAME=claude-code
OTEL_SERVICE_VERSION=1.0.0
OTEL_RESOURCE_ATTRIBUTES=deployment.environment=development,service.namespace=guilde-lite

# ===========================================================================
# OTLP Exporter Configuration
# ===========================================================================

# OTLP endpoint (Alloy collector)
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc

# Individual signal endpoints (optional, defaults to above)
# OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://localhost:4317
# OTEL_EXPORTER_OTLP_METRICS_ENDPOINT=http://localhost:4317
# OTEL_EXPORTER_OTLP_LOGS_ENDPOINT=http://localhost:4317

# ===========================================================================
# Signal-specific Exporters
# ===========================================================================

# Enable all signals
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp
OTEL_LOGS_EXPORTER=otlp

# ===========================================================================
# Sampling Configuration
# ===========================================================================

# Trace sampling (1.0 = 100% of traces)
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=1.0

# ===========================================================================
# Batch Processing
# ===========================================================================

# Batch span processor settings
OTEL_BSP_SCHEDULE_DELAY=5000
OTEL_BSP_MAX_QUEUE_SIZE=2048
OTEL_BSP_MAX_EXPORT_BATCH_SIZE=512
OTEL_BSP_EXPORT_TIMEOUT=30000

# ===========================================================================
# Claude Code Specific (if supported)
# ===========================================================================

# Enable Claude Code telemetry (check if this is supported)
# CLAUDE_CODE_ENABLE_TELEMETRY=1
# CLAUDE_CODE_TELEMETRY_ENDPOINT=http://localhost:4317

# ===========================================================================
# Custom Telemetry Tracking
# ===========================================================================

# Telemetry state directory (used by telemetry-hook.sh)
GUILDE_TELEMETRY_STATE_DIR=${XDG_DATA_HOME:-$HOME/.local/share}/guilde-telemetry
GUILDE_TELEMETRY_SESSION_FILE=${GUILDE_TELEMETRY_STATE_DIR}/current_session.json

# Metrics collection interval (milliseconds)
GUILDE_TELEMETRY_INTERVAL=5000

# Enable debug logging for telemetry hooks
GUILDE_TELEMETRY_DEBUG=false

# ===========================================================================
# Grafana Stack URLs (for reference/scripts)
# ===========================================================================

GRAFANA_URL=http://localhost:3000
LOKI_URL=http://localhost:3100
TEMPO_URL=http://localhost:3200
MIMIR_URL=http://localhost:9009
ALLOY_URL=http://localhost:12345
